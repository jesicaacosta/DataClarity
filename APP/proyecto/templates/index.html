<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inicio - Plataforma de An치lisis de Datos</title>

    <!-- Link a Bootstrap para el estilo -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-MogjQ8jCn7+vjsHVdABM1T6T3N3Iq9Y5B4zt0zB2j1TvR2Df/KUEJqaBPpaJNUXG"
      crossorigin="anonymous"
    />

    <!-- Link a estilos personalizados -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />

    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome para iconos -->
    <script
      src="https://kit.fontawesome.com/7d4a6c3747.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div class="container">
      <!-- Encabezado principal -->
      <div class="text-center mb-4">
        <h1 class="animate__rubberBand">Plataforma de An치lisis de Datos</h1>
        <p class="lead">
          Sub칤 un archivo CSV y analiza tus datos de manera r치pida y sencilla.
        </p>
      </div>

      <!-- Contenedor de formulario para subir archivos -->
      <div class="form-container">
        <form action="/upload" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <label for="file-upload" class="font-weight-bold"
              >游늸Busca tu archivo CSV:</label
            >
            <input
              type="file"
              name="file"
              id="file-upload"
              accept=".csv"
              class="form-control-file"
              title="Subir archivo CSV"
              aria-label="Subir archivo CSV"
            />
          </div>
          <button type="submit" class="btn btn-upload btn-block mt-3">
            Subir y analizar
          </button>
        </form>
      </div>

      <!-- Secci칩n para mostrar los datos cargados -->
      {% if data %}
      <div class="data-table">
        <h2 class="mt-4 font-weight-bold">
          Vista previa de los datos cargados:
        </h2>
        <div class="table-responsive">{{ data|safe }}</div>
      </div>
      {% endif %}

      <!-- Mostrar estad칤sticas b치sicas -->
      {% if stats %}
      <div class="stats-section mt-4">
        <h2>Estad칤sticas B치sicas:</h2>
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>Columna</th>
              <th>Conteo</th>
              <th>Media</th>
              <th>Desviaci칩n Est치ndar</th>
              <th>Valor M칤nimo</th>
              <th>Valor M치ximo</th>
            </tr>
          </thead>
          <tbody>
            {% for column, values in stats.items() %}
            <tr>
              <td>{{ column }}</td>
              <td>{{ values.count }}</td>
              <td>{{ values.mean }}</td>
              <td>{{ values.std_dev }}</td>
              <td>{{ values.min }}</td>
              <td>{{ values.max }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endif %}

      <!-- Formulario para seleccionar columna para el gr치fico -->
      <div class="columna-selector mt-4">
        <h3>Selecciona una columna para el gr치fico:</h3>
        <form id="column-form">
          <label for="selected_column">Columna:</label>
          <select
            name="selected_column"
            id="selected_column"
            class="form-control"
          >
            {% for column in numeric_columns %}
            <option value="{{ column }}">{{ column }}</option>
            {% endfor %}
          </select>
          <button
            type="button"
            id="generate-graph"
            class="btn btn-primary mt-3"
          >
            Generar Gr치fico
          </button>
        </form>
      </div>

      <!-- Mostrar el gr치fico interactivo si est치 disponible -->
      {% if graph %}
      <div class="graph-section mt-4">
        <h2>Gr치fico Interactivo</h2>
        <div>{{ graph|safe }}</div>
      </div>
      {% endif %}

      <!-- Secci칩n para mostrar el gr치fico -->
      <div id="graph" class="graph-section mt-4 hidden"></div>

      <!-- Bootstrap JS y dependencias de Popper -->
      <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
      <script src="{{ url_for('static', filename='js/app.js') }}"></script>
      <!-- Link al archivo JS -->
    </div>
  </body>
</html>
